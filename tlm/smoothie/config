# Smoothieboard configuration file
#
#   See http://smoothieware.org/configuring-smoothie to learn more
#   See http://smoothieware.org/configuration-options for more reference
#
#   ! Lines must not exceed 132 characters
#
# TODO -- measure and confirm these

## we can also use the 'include' keyword :)

#
# G-code player
#   See http://smoothieware.org/player
#
on_boot_gcode_enable                         true
on_boot_gcode                                /sd/on_boot.gcode

#
# Network settings
#   See http://smoothieware.org/network
#
network.enable                               false
network.webserver.enable                     false
network.telnet.enable                        false
network.ip_address                           auto
network.hostname                             kizumi

#
# Delta kinematic geometry
#   See http://smoothieware.org/delta
#
arm_solution                                 linear_delta     # Selects the linear delta arm solution
arm_length                                   400.00           # Length of an arm from hinge to hinge
arm_radius                                   156.80           # Horizontal distance from hinge to hinge with centered effector

#
# Motion configuration
#   See http://smoothieware.org/motion-control
#
default_seek_rate                            6000             # Default speed in mm/min for G0 moves
default_feed_rate                            2400             # Default speed in mm/min for G1/G2/G3 moves
delta_segments_per_second                    100              # Number of segments per second
mm_per_arc_segment                           0.0              # Exact  length for line segments that divide arcs
mm_max_arc_error                             0.01             # Maximum error for line segments that divide arcs

acceleration                                 5000             # Acceleration in mm/sec/sec
junction_deviation                           0.05             # See http://smoothieware.org/motion-control#junction-deviation

x_axis_max_speed                             30000            # Maximum effector speed in mm/min
y_axis_max_speed                             30000            # Maximum effector speed in mm/min
z_axis_max_speed                             30000            # Maximum effector speed in mm/min

alpha_max_rate                               40000            # Maximum X tower carriage speed in mm/min
beta_max_rate                                40000            # Maximum Y tower carriage speed in mm/min
gamma_max_rate                               40000            # Maximum Z tower carriage speed in mm/min

#
# Physical implementation
#   See http://smoothieware.org/stepper-motors
#
# TODO
alpha_steps_per_mm                           159.53           # Steps per mm for alpha ( X ) stepper and tower
beta_steps_per_mm                            159.53           # Steps per mm for beta  ( Y ) stepper and tower
gamma_steps_per_mm                           159.53           # Steps per mm for gamma ( Z ) stepper and tower

#
# Stepper motor configuration 
# Pins are referenced as ports and pin numbers eg Port.pin
#   See http://smoothieware.org/pinout -- physical connections on the control board
#   See http://smoothieware.org/pin-configuration -- more punctuation to set levels and state
#

# X tower

alpha_step_pin                               2.0              # Port.pin for stepper signal
alpha_dir_pin                                0.5              # Port.pin for stepper direction signal
alpha_en_pin                                 0.4              # Port.pin for stepper enable signal
alpha_current                                1.5              # Motor current for stepper

# Y tower

beta_step_pin                                2.1              # Port.pin for stepper signal
beta_dir_pin                                 0.11             # Port.pin for stepper direction signal
beta_en_pin                                  0.10             # Port.pin for stepper enable signal
beta_current                                 1.5              # Motor current for stepper

# Z tower

gamma_step_pin                               2.2              # Port.pin for stepper signal
gamma_dir_pin                                0.20             # Port.pin for stepper direction signal
gamma_en_pin                                 0.19             # Port.pin for stepper enable signal
gamma_current                                1.5              # Motor current for stepper

# Extruder 0

delta_current                                1.3              # Motor current for first extruder stepper

#
# Current control
#   See http://smoothieware.org/currentcontrol
#
currentcontrol_module_enable                 true               # Control stepper motor current via the configuration file

#
# Extruders
#   See http://smoothieware.org/extruder
#   See http://smoothieware.org/pin-configuration -- more punctuation to set levels and state
#

# Extruder 0 -- "hotend"
# TODO
extruder.hotend.enable                       true             # Create and activate new Extruder module "hotend"
extruder.hotend.steps_per_mm                 890              # Steps per mm for extruder stepper
extruder.hotend.default_feed_rate            480              # Default rate in mm/min for moves where only the extruder moves
extruder.hotend.acceleration                 1500             # Acceleration for the stepper motor mm/sec/sec
extruder.hotend.max_speed                    18               # Maximum speed in mm/sec

extruder.hotend.step_pin                     2.3              # Port.pin for extruder stepper signal
extruder.hotend.dir_pin                      0.22             # Port.pin for extruder direction signal
extruder.hotend.en_pin                       0.21             # Port.pin for extruder enable signal

#
# Temperature controllers
#   See http://smoothieware.org/temperaturecontrol
#   See http://smoothieware.org/pin-configuration -- more punctuation to set levels and state
#

# Temperature Control 0 -- "hotend"

temperature_control.hotend.enable               true          # Create and activate new TempCon module "hotend"
temperature_control.hotend.thermistor_pin       0.23          # Port.pin for the thermistor to read
temperature_control.hotend.heater_pin           2.7           # Port.pin that controls the heater
temperature_control.hotend.thermistor           EPCOS100K     # See http://smoothieware.org/temperaturecontrol#thermistor

temperature_control.hotend.set_m_code           104           # M-code to set the temperature for this module
temperature_control.hotend.set_and_wait_m_code  109           # M-code to set-and-wait for this module
temperature_control.hotend.designator           T             # Designator letter for this module in M105 command
# TODO
temperature_control.hotend.max_temp             300           # Set maximum temperature
temperature_control.hotend.min_temp             0             # Set minimum temperature
temperature_control.hotend.p_factor             40.0          # P ( proportional ) factor
temperature_control.hotend.i_factor             3.096         # I ( integral ) factor
temperature_control.hotend.d_factor             129           # D ( derivative ) factor
temperature_control.hotend.max_pwm              255           # Max pwm

temperature_control.hotend.runaway_heating_timeout   600      # How long it can take to heat up in seconds
temperature_control.hotend.runaway_cooling_timeout   1200     # How long it can take to cool down if temp is set lower
temperature_control.hotend.runaway_range             20       # How far from the set temperature it can wander

# Temperature Control 1 -- "bed"

temperature_control.bed.enable                  true          # Create and activate new TempCon module "bed"
temperature_control.bed.thermistor_pin          0.24          # Port.pin for the thermistor to read
temperature_control.bed.heater_pin              2.5           # Port.pin that controls the heater
temperature_control.bed.thermistor              EPCOS100K     # See http://smoothieware.org/temperaturecontrol#thermistor

temperature_control.bed.set_m_code              140           # M-code to set the temperature for this module
temperature_control.bed.set_and_wait_m_code     190           # M-code to set-and-wait for this module
temperature_control.bed.designator              B             # Designator letter for this module in M105 command
# TODO
temperature_control.bed.max_temp                120           # Set maximum temperature
temperature_control.bed.min_temp                0             # Set minimum temperature 
temperature_control.bed.p_factor                204.9         # P ( proportional ) factor
temperature_control.bed.i_factor                9.655         # I ( integral ) factor
temperature_control.bed.d_factor                1087          # D ( derivative ) factor
temperature_control.bed.max_pwm                 255           # Max pwm

temperature_control.bed.runaway_heating_timeout      1000     # How long it can take to heat up in seconds
temperature_control.bed.runaway_cooling_timeout      2000     # How long it can take to cool down if temp is set lower
temperature_control.bed.runaway_range                20       # How far from the set temperature it can wander

#
# Switches
#   See http://smoothieware.org/switch
#   See http://smoothieware.org/pin-configuration -- more punctuation to set levels and state
#

# Switch 0 -- "partfan"

switch.partfan.enable                        true             # Create and activate new Switch module "partfan"
switch.partfan.output_type                   pwm              # Pulse-density settable with S parameter 0...255
switch.partfan.output_pin                    2.4              # Port.pin this module controls
switch.partfan.input_on_command              M106             # Command that will turn this switch on
switch.partfan.input_off_command             M107             # Command that will turn this switch off
switch.partfan.startup_state                 false            # On power-up, use startup_value
switch.partfan.startup_value                 0                # On power-up, set to no speed
switch.partfan.failsafe_set_to               0                # On HALT, set to no speed

# Switch 1 -- "hotendfan"

switch.hotendfan.enable                      true             # Create and activate new Switch module "hotendfan"
switch.hotendfan.output_type                 digital          # This is a static on/off pin
switch.hotendfan.output_pin                  2.6              # Port.pin this module controls
switch.hotendfan.input_on_command            M42              # Command that will turn this switch on
switch.hotendfan.input_off_command           M43              # Command that will turn this switch off
switch.hotendfan.startup_state               false            # On power-up, turn this switch off
switch.hotendfan.failsafe_set_to             1                # On HALT, set to full speed

# Switch 2 -- "bltouch"

switch.bltouch.enable                        true             # Create and activate new Switch module "bltouch"
switch.bltouch.output_type                   hwpwm            # Duty Cycle settable with S parameter 0.0...100.0
switch.bltouch.output_pin                    1.23             # Port.pin this module controls, must be PWM capable
switch.bltouch.pwm_period_ms                 20               # Set period to 20ms (50Hz)
switch.bltouch.input_on_command              M280 S3          # S3 == deploy  probe
switch.bltouch.input_off_command             M280 S7          # S7 == retract probe
switch.bltouch.startup_state                 false            # On power-up, use startup_value
switch.bltouch.startup_value                 10.6             # On power-up or HALT, set to clear errors: dutycyc == 10.6
switch.bltouch.default_on_value              3                # Use 'S3' for a raw M280 command

#
# Z-probe
#   See http://smoothieware.org/zprobe
#   See http://smoothieware.org/pin-configuration -- more punctuation to set levels and state
#
zprobe.enable                                true
zprobe.probe_pin                             1.28^            # Port.pin to read probe trigger signal
zprobe.fast_feedrate                         80               # Moving descent rate mm/sec
zprobe.slow_feedrate                         5                # Probing descent rate in mm/sec
zprobe.return_feedrate                       15               # Returning ascent rate in mm/sec
zprobe.probe_height                          15               # Height in mm above bed to start probe
zprobe.max_z                                 500              # Maximum travel in mm for a probe command

#
# Temperature switches
#   See http://smoothieware.org/temperatureswitch
#

# Temperature Switch 0 -- "hotend"

temperatureswitch.hotend.enable              true             # Create and activate new Temperature Switch module "hotend"
temperatureswitch.hotend.switch              hotendfan        # Set the switch to use by name
temperatureswitch.hotend.designator          T                # Designator character to monitor from command M105
temperatureswitch.hotend.threshold_temp      50.0             # Turn the switch on (if rising) or off (if falling) at this temp
temperatureswitch.hotend.heatup_poll         10               # Poll heatup every N seconds
temperatureswitch.hotend.cooldown_poll       30               # Poll cooldown every N seconds

#
# Endstops
#   See http://smoothieware.org/endstops
#   See http://smoothieware.org/pin-configuration -- more punctuation to set levels and state
#
endstops_enable                              true
delta_homing                                 true             # Forces all three axes home for any G28 command

# X tower

alpha_min_endstop                            nc               # Not connected
alpha_max_endstop                            1.25v            # Port.pin to read max endstop
alpha_homing_direction                       home_to_max      # Move toward max endstop when homing
alpha_max                                    0                # Position when homed
alpha_max_travel                             700              # Max travel in mm when homing
alpha_fast_homing_rate_mm_s                  80               # Fast first pass homing feedrate in mm/sec
alpha_slow_homing_rate_mm_s                  5                # Slow second pass homing feedrate in mm/sec
alpha_homing_retract_mm                      5                # Distance to retract from the endstop after it is hit

# Y tower

beta_min_endstop                             nc               # Not connected
beta_max_endstop                             1.27v            # Port.pin to read max endstop
beta_homing_direction                        home_to_max      # Move toward max endstop when homing
beta_max                                     0                # Position when homed
beta_max_travel                              700              # Max travel in mm when homing
beta_fast_homing_rate_mm_s                   80               # Fast first pass homing feedrate in mm/sec
beta_slow_homing_rate_mm_s                   5                # Slow second pass homing feedrate in mm/sec
beta_homing_retract_mm                       5                # Distance to retract from the endstop after it is hit

# Z tower

gamma_min_endstop                            nc               # Not connected
gamma_max_endstop                            1.29v            # Port.pin to read max endstop
gamma_homing_direction                       home_to_max      # Move toward max endstop when homing
gamma_max                                    520              # Position when homed
gamma_max_travel                             700              # Max travel in mm when homing
gamma_fast_homing_rate_mm_s                  80               # Fast first pass homing feedrate in mm/sec
gamma_slow_homing_rate_mm_s                  5                # Slow second pass homing feedrate in mm/sec
gamma_homing_retract_mm                      5                # Distance to retract from the endstop after it is hit

#
# Levelling strategies
#   See http://smoothieware.org/zprobe#delta-calibration -- measure and calculate physical geometry constants
#   See http://smoothieware.org/zprobe#delta-grid-compensation -- measure and map flatness of the bed
#

leveling-strategy.delta-calibration.enable          true
leveling-strategy.delta-calibration.radius          150       # Probe radius in mm
leveling-strategy.delta-calibration.initial_height  10        # Height in mm above bed to start probing

leveling-strategy.delta-grid.enable                 true
leveling-strategy.delta-grid.radius                 150       # Grid radius in mm
leveling-strategy.delta-grid.size                   9         # Grid points per side, must be an odd number
leveling-strategy.delta-grid.do_home                true      # Whether to home before calibration
leveling-strategy.delta-grid.save                   true      # Whether to automatically save the grid
leveling-strategy.delta-grid.initial_height         10        # Height in mm above bed to start probling
leveling-strategy.delta-grid.probe_offsets          0,0,0     # Probe offset from nozzle in mm as x,y,0

#
# Custom menus
#   See http://smoothieware.org/panel#custom-menu-entries
#
#   NOTE
#     '_' gets converted to ' ' in both the menu and commands
#     '|' gets converted to newline to separate multiple commands
#
custom_menu.coolingfan_off.enable     true              #
custom_menu.coolingfan_off.name       JoeFan_Off       #
custom_menu.coolingfan_off.command    M43               #

custom_menu.coolingfan_on.enable      true              #
custom_menu.coolingfan_on.name        JoeFan_On        #
custom_menu.coolingfan_on.command     M42               #

custom_menu.blower_off.enable         true              #
custom_menu.blower_off.name           Joe_Off        #
custom_menu.blower_off.command        M107              #

custom_menu.blower_on.enable          true              #
custom_menu.blower_on.name            Joe_On         #
custom_menu.blower_on.command         M106_S255         #

custom_menu.bl_up.enable              true              #
custom_menu.bl_up.name                BLJoe_Up        #
custom_menu.bl_up.command             M280_S7           #

custom_menu.bl_down.enable            true              #
custom_menu.bl_down.name              BLJoe_Down      #
custom_menu.bl_down.command           M280_S3           #

custom_menu.bl_reset.enable           true              #
custom_menu.bl_reset.name             BLJoe_Reset     #
custom_menu.bl_reset.command          M280_S10.6        #

custom_menu.bl_test.enable            true              #
custom_menu.bl_test.name              BLJoe_Test      #
custom_menu.bl_test.command           M280_S8.4         #

custom_menu.auto_calibrate.enable     true              #
custom_menu.auto_calibrate.name       Auto_Joe    #
custom_menu.auto_calibrate.command    M280_S10.6|G28|M280_S3|M190_S80|G32|G31|M374|M500|M280_S7|G28|M140_S0|M84|reset #

#
# Kill button
#   See http://smoothieware.org/killbutton
#
kill_button_enable                           true
kill_button_pin                              2.12               # Kill button pin, default is same as pause button 2.12

#
# System configuration
#   See http://smoothieware.org/configuration-options -- "Communication" section
#   See http://smoothieware.org/usb
#
uart0.baud_rate                              115200             # Baud rate for the UART serial port
second_usb_serial_enable                     false              # This enables a second USB serial port

#
# Laser module configuration
#   See http://smoothieware.org/laser
#
laser_module_enable                           false           # Whether to activate the laser module at all
